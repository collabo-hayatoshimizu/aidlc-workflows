# NFR要件

## 前提条件
- ユニットの機能設計が完了している必要がある
- ユニットの機能設計成果物が利用可能である必要がある
- 実行計画がNFR要件ステージを実行すべきことを示す必要がある

## 概要
ユニットの非機能要件を決定し、技術スタックの選択を行います。

## 実行するステップ

### ステップ1：機能設計を分析
- `aidlc-docs/construction/{unit-name}/functional-design/`から機能設計成果物を読み取る
- ビジネスロジックの複雑さと要件を理解

### ステップ2：NFR要件計画を作成
- NFR評価のチェックボックス[]を含む計画を生成
- スケーラビリティ、パフォーマンス、可用性、セキュリティに焦点を当てる
- 各ステップにチェックボックス[]を付ける

### ステップ3：コンテキストに適した質問を生成
**指示**：機能設計を徹底的に分析して、システムの品質とアーキテクチャ決定を改善するNFR明確化が必要なすべての領域を識別します。包括的なNFRカバレッジを確保するために、質問に積極的に取り組んでください。

**重要**：システムの品質に影響する可能性のある曖昧さや欠落している詳細がある場合は、質問をすることをデフォルトにします。質問が多すぎることは、不正確なNFRの推測を行うことよりも良いです。

- [Answer]:タグ形式を使用して質問を埋め込む
- すべての曖昧さ、欠落している情報、または明確化が必要な領域に焦点を当てる
- ユーザー入力がNFRと技術スタックの決定を改善する場所で質問を生成
- **疑わしい場合は質問をする** - 過信は貧弱なシステム品質につながる

**評価する質問カテゴリ**（すべてのカテゴリを検討）：
- **スケーラビリティ要件** - 予想される負荷、成長パターン、スケーリングトリガー、容量計画について尋ねる
- **パフォーマンス要件** - 応答時間、スループット、レイテンシ、パフォーマンスベンチマークについて尋ねる
- **可用性要件** - 稼働時間の期待、災害復旧、フェイルオーバー、事業継続について尋ねる
- **セキュリティ要件** - データ保護、コンプライアンス、認証、認可、脅威モデルについて尋ねる
- **技術スタックの選択** - 技術の好み、制約、既存システム、統合要件について尋ねる
- **信頼性要件** - エラー処理、耐障害性、モニタリング、アラートのニーズについて尋ねる
- **保守性要件** - コード品質、ドキュメント、テスト、運用要件について尋ねる
- **ユーザビリティ要件** - ユーザーエクスペリエンス、アクセシビリティ、インターフェース要件について尋ねる

### ステップ4：計画を保存
- `aidlc-docs/construction/plans/{unit-name}-nfr-requirements-plan.md`として保存
- ユーザー入力のためのすべての[Answer]:タグを含める

### ステップ5：回答を収集して分析
- ユーザーがすべての[Answer]:タグを完了するのを待つ
- **必須**：すべての応答を曖昧または曖昧な回答について慎重に確認
- **重要**：不明確な応答にフォローアップ質問を追加 - 曖昧さを持って進まない
- 「依存する」、「多分」、「確信がない」、「混合」、「中間」、「標準」、「典型的」のような応答を探す
- 曖昧さが検出された場合は明確化質問ファイルを作成
- **すべての曖昧さが解決されるまで進まない**

### ステップ6：NFR要件成果物を生成
- `aidlc-docs/construction/{unit-name}/nfr-requirements/nfr-requirements.md`を作成
- `aidlc-docs/construction/{unit-name}/nfr-requirements/tech-stack-decisions.md`を作成

### ステップ7：完了メッセージを提示
- この構造で完了メッセージを提示：
     1. **完了アナウンス**（必須）：常にこれで始める：

```markdown
# 📊 NFR要件完了 - [unit-name]
```

     2. **AIサマリー**（オプション）：NFR要件の構造化された箇条書きサマリーを提供
        - 形式：「NFR要件評価により[説明]が特定されました：」
        - 主要なスケーラビリティ、パフォーマンス、可用性要件をリスト（箇条書き）
        - 特定されたセキュリティとコンプライアンス要件をリスト
        - 技術スタックの決定と理由を言及
        - ワークフロー指示を含めない（「確認してください」、「お知らせください」、「次のフェーズに進む」、「進む前に」）
        - 事実的でコンテンツに焦点を当てる
     3. **フォーマットされたワークフローメッセージ**（必須）：常にこの正確な形式で終わる：

```markdown
> **📋 <u>**確認が必要：**</u>**  
> 以下のNFR要件を確認してください：`aidlc-docs/construction/[unit-name]/nfr-requirements/`



> **🚀 <u>**次は何ですか？**</u>**
>
> **以下を行うことができます：**
>
> 🔧 **変更を要求** - 確認に基づいてNFR要件への変更を依頼
> ✅ **次のステージに続行** - NFR要件を承認して**[next-stage-name]**に進む

---
```

### ステップ8：明示的な承認を待つ
- ユーザーがNFR要件を明示的に承認するまで進まない
- 承認は明確で曖昧さがない必要がある
- ユーザーが変更を要求した場合は、要件を更新して承認プロセスを繰り返す

### ステップ9：承認を記録して進捗を更新
- タイムスタンプ付きでaudit.mdに承認を記録
- タイムスタンプ付きでユーザーの承認応答を記録
- aidlc-state.mdでNFR要件ステージを完了としてマーク
